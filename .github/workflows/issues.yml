# https://github.com/mkungla/github-cicd/discussions/11
on:
  issues:
    types:
      - opened
      - edited
      - deleted
      - transferred
      - pinned
      - unpinned
      - closed
      - reopened
      - assigned
      - unassigned
      - labeled
      - unlabeled
      - locked
      - unlocked
      - milestoned
      - demilestoned

  # https://github.com/mkungla/github-cicd/discussions/11#discussioncomment-1233633
  issue_comment:
    types:
      - created
      - deleted
      - edited

defaults:
  runs-on: ubuntu-latest
  steps:
    - run: |
        echo "${{ github.event.sender.login }} triggered ${{ github.event.action }} issue #${{ github.event.issue.number }}"
    - run: echo ${{ toJSON(github) }}
    - run: echo ${{ toJSON(env) }}
    - run: echo ${{ toJSON(job) }}
    - run: echo ${{ toJSON(steps) }}
    - run: echo ${{ toJSON(runner) }}
    - run: echo ${{ toJSON(needs) }}

jobs:
  not-a-pull-request:
    if: github.event_name === 'issues' && github.event.issue.pull_request
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "issue #${{ github.event.issue.number }} pull_request #${{ github.event.issue.pull_request }}"
          exit 1

  opened:
    if: github.event.action == 'opened'
    steps:
      - run: |
          echo "${{ github.event.sender.login }} triggered ${{ github.event.action }} issue #${{ github.event.issue.number }}"

  # edited:
  #   if: github.event.action == 'edited'

  # deleted:
  #   if: github.event.action == 'deleted'

  # transferred:
  #   if: github.event.action == 'transferred'

  # pinned:
  #   if: github.event.action == 'pinned'

  # unpinned:
  #   if: github.event.action == 'unpinned'

  # closed:
  #   if: github.event.action == 'closed'

  # reopened:
  #   if: github.event.action == 'reopened'

  # assigned:
  #   if: github.event.action == 'assigned'

  # unassigned:
  #   if: github.event.action == 'unassigned'

  # labeled:
  #   if: github.event.action == 'labeled'

  # unlabeled:
  #   if: github.event.action == 'unlabeled'

  # locked:
  #   if: github.event.action == 'locked'

  # unlocked:
  #   if: github.event.action == 'unlocked'

  # milestoned:
  #   if: github.event.action == 'milestoned'

  # demilestoned:
  #   if: github.event.action == 'demilestoned'

  issue-comment:
    name: Issue comment
    if: github.event_name === 'issue_comment' && !github.event.issue.pull_request
    runs-on: ubuntu-latest
    steps:
      - if: github.event.action == 'created'
        run: |
          echo "${{ github.event.sender.login }} commented on issue #${{ github.event.issue.number }}"
      - if: github.event.action == 'deleted'
        run: |
          echo "${{ github.event.sender.login }} deleted comment on issue #${{ github.event.issue.number }}"
      - if: github.event.action == 'edited'
        run: |
          echo "${{ github.event.sender.login }} edited comment on issue #${{ github.event.issue.number }}"
